-- commands to populate the database from csv

\COPY local_gov_area (LGA_CODE_2021, LGA_Name, url_name, url_fullname) FROM './resources/2021_ASGS_Non_ABS_Structures.csv' WITH DELIMITER ',' CSV HEADER;

\COPY selected_medians (LGA_CODE_2021, Median_age_persons, Median_mortgage_repay_monthly, Median_tot_prsnl_inc_weekly, Median_rent_weekly, Median_tot_fam_inc_weekly, Average_num_psns_per_bedroom, Median_tot_hhd_inc_weekly, Average_household_size) FROM './resources/cleaned/2021Census_G02_VIC_LGA.csv' WITH DELIMITER ',' CSV HEADER;

\COPY vehicles_per_dwelling (LGA_CODE_2021, Num_MVs_per_dweling_0_MVs, Num_MVs_per_dweling_1_MVs, Num_MVs_per_dweling_2_MVs, Num_MVs_per_dweling_3_MVs, Num_MVs_per_dweling_4mo_MVs, Num_MVs_per_dweling_Tot, Num_MVs_NS, Total_dwelings) FROM './resources/cleaned/2021Census_G34_VIC_LGA.csv' WITH DELIMITER ',' CSV HEADER; 

\COPY dwelling_structure (LGA_CODE_2021, OPDs_Separate_house_Dwellings, OPDs_Separate_house_Persons, OPDs_SD_r_t_h_th_1_sty_Dwgs, OPDs_SD_r_t_h_th_1_sty_Psns, OPDs_SD_r_t_h_th_2_m_sty_Dwgs, OPDs_SD_r_t_h_th_2_m_sty_Psns, OPDs_SD_r_t_h_th_Tot_Dwgs, OPDs_SD_r_t_h_th_Tot_Psns, OPDs_F_ap_I_1or2_sty_blk_Ds, OPDs_F_ap_I_1or2_sty_blk_Ps, OPDs_F_ap_I_3_sty_blk_Dwgs, OPDs_F_ap_I_3_sty_blk_Psns, OPDs_F_ap_I_4to8_sty_blk_Ds, OPDs_F_ap_I_4to8_sty_blk_Ps, OPDs_F_ap_I_9_m_sty_blk_Ds, OPDs_F_ap_I_9_m_sty_blk_Ps, OPDs_Flt_apt_Att_house_Ds, OPDs_Flt_apt_Att_house_Ps, OPDs_Flt_apart_Tot_Dwgs, OPDs_Flt_apart_Tot_Psns, OPDs_Oth_dwg_Cvn_Ds, OPDs_Oth_dw_Cvn_Ps, OPDs_Oth_dwg_cab_hboat_Ds, OPDs_Oth_dwg_cab_hboat_Ps, OPDs_Ot_dwg_Im_hm_tnt_SO_Ds, OPDs_Ot_dwg_Im_hm_tnt_SO_Ps, OPDs_Ot_dwg_Hs_f_att_sh_of_Ds, OPDs_Ot_dwg_Hs_f_att_sh_of_Ps, OPDs_Other_dwelling_Tot_Dwgs, OPDs_Other_dwelling_Tot_Psns, OPDs_Dwlling_structur_NS_Dwgs, OPDs_Dwlling_structur_NS_Psns, OPDs_Tot_OPDs_Dwellings, OPDs_Tot_OPDs_Persons, Unoccupied_PDs_Dwgs, Unoccupied_PDs_Psns, Total_PDs_Dwellings, Total_PDs_Persons) FROM './resources/cleaned/2021Census_G36_VIC_LGA.csv' WITH DELIMITER ',' CSV HEADER;

\COPY dwellings_by_bedroom (LGA_CODE_2021, Separate_house_NofB_0_i_b, Separate_house_NofB_1, Separate_house_NofB_2, Separate_house_NofB_3, Separate_house_NofB_4, Separate_house_NofB_5, Separate_house_NofB_6_or_m, Separate_house_NofB_NS, Separate_house_Total, Se_d_r_or_t_h_t_1_s_NofB_0_ib, Se_d_r_or_t_h_t_1_st_NofB_1, Se_d_r_or_t_h_t_1_st_NofB_2, Se_d_r_or_t_h_t_1_st_NofB_3, Se_d_r_or_t_h_t_1_st_NofB_4, Se_d_r_or_t_h_t_1_st_NofB_5, Se_d_r_or_t_h_t_1_st_NofB_6_m, Se_d_r_or_t_h_t_1_st_NofB_NS, Se_d_r_or_t_h_t_1_st_Total, Se_d_r_or_t_h_t_2_s_NofB_0_ib, Se_d_r_or_t_h_t_2_sts_NofB_1, Se_d_r_or_t_h_t_2_sts_NofB_2, Se_d_r_or_t_h_t_2_sts_NofB_3, Se_d_r_or_t_h_t_2_sts_NofB_4, Se_d_r_or_t_h_t_2_sts_NofB_5, Se_d_r_or_t_h_t_2_st_NofB_6_m, Se_d_r_or_t_h_t_2_sts_NofB_NS, Se_d_r_or_t_h_t_2_sts_Total, Se_d_r_or_t_h_t_Tot_NofB_0_ib, Se_d_r_or_t_h_t_Tot_NofB_1, Se_d_r_or_t_h_t_Tot_NofB_2, Se_d_r_or_t_h_t_Tot_NofB_3, Se_d_r_or_t_h_t_Tot_NofB_4, Se_d_r_or_t_h_t_Tot_NofB_5, Se_d_r_or_t_h_t_Tot_NofB_6_m, Se_d_r_or_t_h_t_Tot_NofB_NS, Se_d_r_or_t_h_t_Tot_Total, Flt_at_1or2_st_bl_NofB_0_ib, Flt_at_In_1or2_s_b_NofB_1, Flt_at_In_1or2_s_b_NofB_2, Flt_at_In_1or2_s_b_NofB_3, Flt_at_In_1or2_s_b_NofB_4, Flt_at_In_1or2_s_b_NofB_5, Flt_at_In_1or2_s_b_NoB_6_m, Flt_at_In_1or2_s_b_NoB_NS, Flt_at_In_1or2_s_b_Total, Flt_apt_3_st_bl_NoB_0_ib, Flt_apt_In_3_st_bl_NofB_1, Flt_apt_In_3_st_bl_NofB_2, Flt_apt_In_3_st_bl_NofB_3, Flt_apt_In_3_st_bl_NofB_4, Flt_apt_In_3_st_bl_NofB_5, Flt_apt_In_3_s_bl_NofB_6_m, Flt_apt_In_3_st_bl_NofB_NS, Flt_apt_In_3_st_bl_Total, Flt_apt_4to8_s_b_NofB_0_ib, Flt_apt_4to8_s_b_NofB_1, Flt_apt_4to8_s_b_NofB_2, Flt_apt_4to8_s_b_NofB_3, Flt_apt_4to8_s_b_NofB_4, Flt_apt_4to8_s_b_NofB_5, Flt_apt_4to8_s_b_NofB_6_m, Flt_apt_4to8_s_b_NofB_NS, Flt_apt_4to8_s_b_Total, Flt_apt_9_or_m_s_b_NofB_0_ib, Flt_apt_9_or_m_s_b_NofB_1, Flt_apt_9_or_m_s_b_NofB_2, Flt_apt_9_or_m_s_b_NofB_3, Flt_apt_9_or_m_s_b_NofB_4, Flt_apt_9_or_m_s_b_NofB_5, Flt_apt_9_or_m_s_b_NofB_6_m, Flt_apt_9_or_m_s_b_NofB_NS, Flt_apt_9_or_m_s_b_Total, Flt_apt_At_to_a_h_NofB_0_ib, Flt_apt_At_to_a_hse_NofB_1, Flt_apt_At_to_a_hse_NofB_2, Flt_apt_At_to_a_hse_NofB_3, Flt_apt_At_to_a_hse_NofB_4, Flt_apt_At_to_a_hse_NofB_5, Flt_apt_At_to_a_hs_NofB_6_m, Flt_apt_At_to_a_hs_NofB_NS, Flt_apt_At_to_a_hse_Total, Flt_apart_Tot_NofB_0_i_b, Flt_apart_Tot_NofB_1, Flt_apart_Tot_NofB_2, Flt_apart_Tot_NofB_3, Flt_apart_Tot_NofB_4, Flt_apart_Tot_NofB_5, Flt_apart_Tot_NofB_6_or_m, Flt_apart_Tot_NofB_NS, Flt_apart_Tot_Total, Other_dwelling_NofB_0_i_b, Other_dwelling_NofB_1, Other_dwelling_NofB_2, Other_dwelling_NofB_3, Other_dwelling_NofB_4, Other_dwelling_NofB_5, Other_dwelling_NofB_6_or_m, Other_dwelling_NofB_NS, Other_dwelling_Total, Dweling_structu_NS_NofB_0_i_b, Dweling_structur_NS_NofB_1, Dweling_structur_NS_NofB_2, Dweling_structur_NS_NofB_3, Dweling_structur_NS_NofB_4, Dweling_structur_NS_NofB_5, Dwelig_struct_NS_NofB_6_or_m, Dweling_structur_NS_NofB_NS, Dweling_structur_NS_Total, Total_NofB_0_i_b, Total_NofB_1, Total_NofB_2, Total_NofB_3, Total_NofB_4, Total_NofB_5, Total_NofB_6_or_m, Total_NofB_NS, Total_Total) FROM './resources/cleaned/2021Census_G41_VIC_LGA.csv' WITH DELIMITER ',' CSV HEADER;

-- create joined census view for querying with transforms

CREATE TABLE vic_selected_census AS
SELECT * -- this bit can be edited to create simple transformed columns
  FROM local_gov_area
           LEFT JOIN dwellings_by_bedroom USING (lga_code_2021)
           LEFT JOIN dwelling_structure USING (lga_code_2021)
           LEFT JOIN selected_medians USING (lga_code_2021)
           LEFT JOIN vehicles_per_dwelling USING (lga_code_2021)
 WHERE LEFT(lga_code_2021, 4) = 'LGA2'
